2026-02-14 23:33:03,749 - __main__ - INFO - 
======================================================================
2026-02-14 23:33:03,749 - __main__ - INFO - CASSI Algorithm 1 & 2 Validation on 10 Scenes
2026-02-14 23:33:03,749 - __main__ - INFO - ======================================================================
2026-02-14 23:33:03,767 - __main__ - WARNING - Real mask has wrong shape (660, 660), resizing to (256, 256)
2026-02-14 23:33:03,790 - __main__ - INFO - Ideal mask shape: (256, 256)
2026-02-14 23:33:03,791 - __main__ - INFO - Real mask shape: (256, 256)
2026-02-14 23:33:03,791 - __main__ - INFO - scene01 not found, using synthetic scene
2026-02-14 23:33:03,814 - __main__ - INFO - Using scene01: (256, 256, 28)
2026-02-14 23:33:03,815 - __main__ - INFO - 
======================================================================
2026-02-14 23:33:03,815 - __main__ - INFO - Scene 1/10
2026-02-14 23:33:03,815 - __main__ - INFO - ======================================================================
2026-02-14 23:33:03,815 - __main__ - INFO - Scenario I: Ideal reconstruction
2026-02-14 23:33:04,061 - __main__ - INFO - Scenario II: Assumed mask (baseline)
2026-02-14 23:33:04,297 - __main__ - INFO - Scenario III: Corrected mask (Algorithms 1 & 2)
2026-02-14 23:33:05,825 - __main__ - INFO - Running Algorithm 1...
2026-02-14 23:33:05,825 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1: Hierarchical Beam Search starting...
2026-02-14 23:33:05,825 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1: Estimating mask geometry (dx, dy, theta)...
2026-02-14 23:33:08,366 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dx: best=0.0000, mse=0.186231
2026-02-14 23:33:10,826 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dy: best=0.5000, mse=0.186246
2026-02-14 23:33:12,138 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep theta: best=1.0000, mse=0.186231
2026-02-14 23:33:35,938 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Beam search affine: top 5 candidates found, best mse=0.186220
2026-02-14 23:33:35,939 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1 result: dx=-0.2500, dy=1.0000, theta=1.0000
2026-02-14 23:33:35,939 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2: Estimating dispersion (a1, alpha)...
2026-02-14 23:33:42,532 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2 result: a1=1.9500, alpha=-0.3333
2026-02-14 23:33:42,532 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1 completed in 36.7 seconds
2026-02-14 23:33:42,533 - __main__ - INFO - Algorithm 1 result: MismatchParameters(dx=-0.250, dy=1.000, θ=1.000°, a1=1.9500, α=-0.333°)
2026-02-14 23:33:42,533 - __main__ - INFO - Running Algorithm 2...
2026-02-14 23:33:42,650 - __main__ - ERROR - Algorithm 2 failed: Algorithm2JointGradientRefinement.refine() missing 2 required positional arguments: 'x_true' and 's_nom'
2026-02-14 23:33:42,892 - __main__ - INFO - Scene I (Ideal) PSNR: 40.03 dB
2026-02-14 23:33:42,892 - __main__ - INFO - Scene II (Assumed) PSNR: 23.43 dB
2026-02-14 23:33:42,892 - __main__ - INFO - Scene III (Corrected) PSNR: 28.49 dB
2026-02-14 23:33:42,892 - __main__ - INFO - Gap I→II: 16.60 dB (degradation)
2026-02-14 23:33:42,892 - __main__ - INFO - Gain II→III: 5.06 dB (correction)
2026-02-14 23:33:42,892 - __main__ - INFO - Gap III→I: 11.54 dB (residual)
2026-02-14 23:33:42,892 - __main__ - INFO - scene02 not found, using synthetic scene
2026-02-14 23:33:42,914 - __main__ - INFO - Using scene02: (256, 256, 28)
2026-02-14 23:33:42,914 - __main__ - INFO - 
======================================================================
2026-02-14 23:33:42,914 - __main__ - INFO - Scene 2/10
2026-02-14 23:33:42,914 - __main__ - INFO - ======================================================================
2026-02-14 23:33:42,914 - __main__ - INFO - Scenario I: Ideal reconstruction
2026-02-14 23:33:43,166 - __main__ - INFO - Scenario II: Assumed mask (baseline)
2026-02-14 23:33:43,410 - __main__ - INFO - Scenario III: Corrected mask (Algorithms 1 & 2)
2026-02-14 23:33:43,413 - __main__ - INFO - Running Algorithm 1...
2026-02-14 23:33:43,413 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1: Hierarchical Beam Search starting...
2026-02-14 23:33:43,413 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1: Estimating mask geometry (dx, dy, theta)...
2026-02-14 23:33:45,821 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dx: best=2.5000, mse=0.186540
2026-02-14 23:33:48,256 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dy: best=0.0000, mse=0.186549
2026-02-14 23:33:49,544 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep theta: best=-0.3333, mse=0.186515
2026-02-14 23:34:13,321 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Beam search affine: top 5 candidates found, best mse=0.186506
2026-02-14 23:34:13,322 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1 result: dx=3.0000, dy=0.2500, theta=-0.3333
2026-02-14 23:34:13,322 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2: Estimating dispersion (a1, alpha)...
2026-02-14 23:34:19,849 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2 result: a1=1.9500, alpha=0.3333
2026-02-14 23:34:19,850 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1 completed in 36.4 seconds
2026-02-14 23:34:19,850 - __main__ - INFO - Algorithm 1 result: MismatchParameters(dx=3.000, dy=0.250, θ=-0.333°, a1=1.9500, α=0.333°)
2026-02-14 23:34:19,850 - __main__ - INFO - Running Algorithm 2...
2026-02-14 23:34:19,851 - __main__ - ERROR - Algorithm 2 failed: Algorithm2JointGradientRefinement.refine() missing 2 required positional arguments: 'x_true' and 's_nom'
2026-02-14 23:34:20,087 - __main__ - INFO - Scene I (Ideal) PSNR: 40.04 dB
2026-02-14 23:34:20,087 - __main__ - INFO - Scene II (Assumed) PSNR: 23.43 dB
2026-02-14 23:34:20,087 - __main__ - INFO - Scene III (Corrected) PSNR: 28.50 dB
2026-02-14 23:34:20,087 - __main__ - INFO - Gap I→II: 16.60 dB (degradation)
2026-02-14 23:34:20,087 - __main__ - INFO - Gain II→III: 5.06 dB (correction)
2026-02-14 23:34:20,087 - __main__ - INFO - Gap III→I: 11.54 dB (residual)
2026-02-14 23:34:20,087 - __main__ - INFO - scene03 not found, using synthetic scene
2026-02-14 23:34:20,107 - __main__ - INFO - Using scene03: (256, 256, 28)
2026-02-14 23:34:20,107 - __main__ - INFO - 
======================================================================
2026-02-14 23:34:20,107 - __main__ - INFO - Scene 3/10
2026-02-14 23:34:20,107 - __main__ - INFO - ======================================================================
2026-02-14 23:34:20,107 - __main__ - INFO - Scenario I: Ideal reconstruction
2026-02-14 23:34:20,362 - __main__ - INFO - Scenario II: Assumed mask (baseline)
2026-02-14 23:34:20,599 - __main__ - INFO - Scenario III: Corrected mask (Algorithms 1 & 2)
2026-02-14 23:34:20,602 - __main__ - INFO - Running Algorithm 1...
2026-02-14 23:34:20,602 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1: Hierarchical Beam Search starting...
2026-02-14 23:34:20,602 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1: Estimating mask geometry (dx, dy, theta)...
2026-02-14 23:34:23,004 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dx: best=-2.5000, mse=0.186363
2026-02-14 23:34:25,419 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dy: best=2.0000, mse=0.186375
2026-02-14 23:34:26,737 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep theta: best=0.3333, mse=0.186355
2026-02-14 23:34:51,238 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Beam search affine: top 5 candidates found, best mse=0.186324
2026-02-14 23:34:51,239 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1 result: dx=-2.7500, dy=1.5000, theta=0.3833
2026-02-14 23:34:51,239 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2: Estimating dispersion (a1, alpha)...
2026-02-14 23:34:57,888 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2 result: a1=2.0500, alpha=-0.6667
2026-02-14 23:34:57,888 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1 completed in 37.3 seconds
2026-02-14 23:34:57,889 - __main__ - INFO - Algorithm 1 result: MismatchParameters(dx=-2.750, dy=1.500, θ=0.383°, a1=2.0500, α=-0.667°)
2026-02-14 23:34:57,889 - __main__ - INFO - Running Algorithm 2...
2026-02-14 23:34:57,889 - __main__ - ERROR - Algorithm 2 failed: Algorithm2JointGradientRefinement.refine() missing 2 required positional arguments: 'x_true' and 's_nom'
2026-02-14 23:34:58,125 - __main__ - INFO - Scene I (Ideal) PSNR: 40.03 dB
2026-02-14 23:34:58,125 - __main__ - INFO - Scene II (Assumed) PSNR: 23.43 dB
2026-02-14 23:34:58,125 - __main__ - INFO - Scene III (Corrected) PSNR: 28.49 dB
2026-02-14 23:34:58,125 - __main__ - INFO - Gap I→II: 16.60 dB (degradation)
2026-02-14 23:34:58,125 - __main__ - INFO - Gain II→III: 5.06 dB (correction)
2026-02-14 23:34:58,125 - __main__ - INFO - Gap III→I: 11.54 dB (residual)
2026-02-14 23:34:58,126 - __main__ - INFO - scene04 not found, using synthetic scene
2026-02-14 23:34:58,146 - __main__ - INFO - Using scene04: (256, 256, 28)
2026-02-14 23:34:58,146 - __main__ - INFO - 
======================================================================
2026-02-14 23:34:58,146 - __main__ - INFO - Scene 4/10
2026-02-14 23:34:58,146 - __main__ - INFO - ======================================================================
2026-02-14 23:34:58,146 - __main__ - INFO - Scenario I: Ideal reconstruction
2026-02-14 23:34:58,406 - __main__ - INFO - Scenario II: Assumed mask (baseline)
2026-02-14 23:34:58,654 - __main__ - INFO - Scenario III: Corrected mask (Algorithms 1 & 2)
2026-02-14 23:34:58,657 - __main__ - INFO - Running Algorithm 1...
2026-02-14 23:34:58,657 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1: Hierarchical Beam Search starting...
2026-02-14 23:34:58,657 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1: Estimating mask geometry (dx, dy, theta)...
2026-02-14 23:35:01,103 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dx: best=-1.5000, mse=0.186398
2026-02-14 23:35:03,529 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dy: best=0.5000, mse=0.186439
2026-02-14 23:35:04,839 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep theta: best=0.6667, mse=0.186410
2026-02-14 23:35:28,126 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Beam search affine: top 5 candidates found, best mse=0.186389
2026-02-14 23:35:28,127 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1 result: dx=-1.7500, dy=1.0000, theta=0.6167
2026-02-14 23:35:28,127 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2: Estimating dispersion (a1, alpha)...
2026-02-14 23:35:34,593 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2 result: a1=2.0500, alpha=0.3333
2026-02-14 23:35:34,593 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1 completed in 35.9 seconds
2026-02-14 23:35:34,594 - __main__ - INFO - Algorithm 1 result: MismatchParameters(dx=-1.750, dy=1.000, θ=0.617°, a1=2.0500, α=0.333°)
2026-02-14 23:35:34,594 - __main__ - INFO - Running Algorithm 2...
2026-02-14 23:35:34,595 - __main__ - ERROR - Algorithm 2 failed: Algorithm2JointGradientRefinement.refine() missing 2 required positional arguments: 'x_true' and 's_nom'
2026-02-14 23:35:34,831 - __main__ - INFO - Scene I (Ideal) PSNR: 40.03 dB
2026-02-14 23:35:34,831 - __main__ - INFO - Scene II (Assumed) PSNR: 23.44 dB
2026-02-14 23:35:34,831 - __main__ - INFO - Scene III (Corrected) PSNR: 28.50 dB
2026-02-14 23:35:34,831 - __main__ - INFO - Gap I→II: 16.60 dB (degradation)
2026-02-14 23:35:34,831 - __main__ - INFO - Gain II→III: 5.06 dB (correction)
2026-02-14 23:35:34,831 - __main__ - INFO - Gap III→I: 11.54 dB (residual)
2026-02-14 23:35:34,831 - __main__ - INFO - scene05 not found, using synthetic scene
2026-02-14 23:35:34,851 - __main__ - INFO - Using scene05: (256, 256, 28)
2026-02-14 23:35:34,851 - __main__ - INFO - 
======================================================================
2026-02-14 23:35:34,852 - __main__ - INFO - Scene 5/10
2026-02-14 23:35:34,852 - __main__ - INFO - ======================================================================
2026-02-14 23:35:34,852 - __main__ - INFO - Scenario I: Ideal reconstruction
2026-02-14 23:35:35,101 - __main__ - INFO - Scenario II: Assumed mask (baseline)
2026-02-14 23:35:35,337 - __main__ - INFO - Scenario III: Corrected mask (Algorithms 1 & 2)
2026-02-14 23:35:35,340 - __main__ - INFO - Running Algorithm 1...
2026-02-14 23:35:35,340 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1: Hierarchical Beam Search starting...
2026-02-14 23:35:35,340 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1: Estimating mask geometry (dx, dy, theta)...
2026-02-14 23:35:37,759 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dx: best=-0.5000, mse=0.186394
2026-02-14 23:35:40,162 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dy: best=2.5000, mse=0.186431
2026-02-14 23:35:41,455 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep theta: best=0.3333, mse=0.186421
2026-02-14 23:36:05,241 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Beam search affine: top 5 candidates found, best mse=0.186392
2026-02-14 23:36:05,242 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1 result: dx=0.0000, dy=2.7500, theta=0.3833
2026-02-14 23:36:05,242 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2: Estimating dispersion (a1, alpha)...
2026-02-14 23:36:11,918 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2 result: a1=1.9500, alpha=0.0000
2026-02-14 23:36:11,918 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1 completed in 36.6 seconds
2026-02-14 23:36:11,919 - __main__ - INFO - Algorithm 1 result: MismatchParameters(dx=0.000, dy=2.750, θ=0.383°, a1=1.9500, α=0.000°)
2026-02-14 23:36:11,919 - __main__ - INFO - Running Algorithm 2...
2026-02-14 23:36:11,919 - __main__ - ERROR - Algorithm 2 failed: Algorithm2JointGradientRefinement.refine() missing 2 required positional arguments: 'x_true' and 's_nom'
2026-02-14 23:36:12,163 - __main__ - INFO - Scene I (Ideal) PSNR: 40.03 dB
2026-02-14 23:36:12,163 - __main__ - INFO - Scene II (Assumed) PSNR: 23.43 dB
2026-02-14 23:36:12,163 - __main__ - INFO - Scene III (Corrected) PSNR: 28.50 dB
2026-02-14 23:36:12,163 - __main__ - INFO - Gap I→II: 16.59 dB (degradation)
2026-02-14 23:36:12,163 - __main__ - INFO - Gain II→III: 5.06 dB (correction)
2026-02-14 23:36:12,163 - __main__ - INFO - Gap III→I: 11.53 dB (residual)
2026-02-14 23:36:12,163 - __main__ - INFO - scene06 not found, using synthetic scene
2026-02-14 23:36:12,183 - __main__ - INFO - Using scene06: (256, 256, 28)
2026-02-14 23:36:12,183 - __main__ - INFO - 
======================================================================
2026-02-14 23:36:12,183 - __main__ - INFO - Scene 6/10
2026-02-14 23:36:12,183 - __main__ - INFO - ======================================================================
2026-02-14 23:36:12,183 - __main__ - INFO - Scenario I: Ideal reconstruction
2026-02-14 23:36:12,432 - __main__ - INFO - Scenario II: Assumed mask (baseline)
2026-02-14 23:36:12,667 - __main__ - INFO - Scenario III: Corrected mask (Algorithms 1 & 2)
2026-02-14 23:36:12,670 - __main__ - INFO - Running Algorithm 1...
2026-02-14 23:36:12,670 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1: Hierarchical Beam Search starting...
2026-02-14 23:36:12,670 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1: Estimating mask geometry (dx, dy, theta)...
2026-02-14 23:36:15,316 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dx: best=-1.0000, mse=0.186379
2026-02-14 23:36:17,757 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dy: best=-2.0000, mse=0.186410
2026-02-14 23:36:19,076 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep theta: best=0.0000, mse=0.186402
2026-02-14 23:36:45,903 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Beam search affine: top 5 candidates found, best mse=0.186401
2026-02-14 23:36:45,904 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1 result: dx=-1.2500, dy=-2.2500, theta=0.1000
2026-02-14 23:36:45,904 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2: Estimating dispersion (a1, alpha)...
2026-02-14 23:36:52,698 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2 result: a1=2.0500, alpha=1.0000
2026-02-14 23:36:52,698 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1 completed in 40.0 seconds
2026-02-14 23:36:52,699 - __main__ - INFO - Algorithm 1 result: MismatchParameters(dx=-1.250, dy=-2.250, θ=0.100°, a1=2.0500, α=1.000°)
2026-02-14 23:36:52,699 - __main__ - INFO - Running Algorithm 2...
2026-02-14 23:36:52,700 - __main__ - ERROR - Algorithm 2 failed: Algorithm2JointGradientRefinement.refine() missing 2 required positional arguments: 'x_true' and 's_nom'
2026-02-14 23:36:52,955 - __main__ - INFO - Scene I (Ideal) PSNR: 40.02 dB
2026-02-14 23:36:52,955 - __main__ - INFO - Scene II (Assumed) PSNR: 23.43 dB
2026-02-14 23:36:52,955 - __main__ - INFO - Scene III (Corrected) PSNR: 28.50 dB
2026-02-14 23:36:52,955 - __main__ - INFO - Gap I→II: 16.59 dB (degradation)
2026-02-14 23:36:52,956 - __main__ - INFO - Gain II→III: 5.07 dB (correction)
2026-02-14 23:36:52,956 - __main__ - INFO - Gap III→I: 11.52 dB (residual)
2026-02-14 23:36:52,956 - __main__ - INFO - scene07 not found, using synthetic scene
2026-02-14 23:36:52,976 - __main__ - INFO - Using scene07: (256, 256, 28)
2026-02-14 23:36:52,976 - __main__ - INFO - 
======================================================================
2026-02-14 23:36:52,976 - __main__ - INFO - Scene 7/10
2026-02-14 23:36:52,976 - __main__ - INFO - ======================================================================
2026-02-14 23:36:52,976 - __main__ - INFO - Scenario I: Ideal reconstruction
2026-02-14 23:36:53,249 - __main__ - INFO - Scenario II: Assumed mask (baseline)
2026-02-14 23:36:53,494 - __main__ - INFO - Scenario III: Corrected mask (Algorithms 1 & 2)
2026-02-14 23:36:53,496 - __main__ - INFO - Running Algorithm 1...
2026-02-14 23:36:53,496 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1: Hierarchical Beam Search starting...
2026-02-14 23:36:53,497 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1: Estimating mask geometry (dx, dy, theta)...
2026-02-14 23:36:56,626 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dx: best=0.0000, mse=0.186243
2026-02-14 23:36:59,446 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dy: best=3.0000, mse=0.186243
2026-02-14 23:37:00,904 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep theta: best=-1.0000, mse=0.186231
2026-02-14 23:37:35,315 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Beam search affine: top 5 candidates found, best mse=0.186197
2026-02-14 23:37:35,316 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1 result: dx=0.5000, dy=2.7500, theta=-1.0000
2026-02-14 23:37:35,316 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2: Estimating dispersion (a1, alpha)...
2026-02-14 23:37:47,180 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2 result: a1=1.9750, alpha=-0.6667
2026-02-14 23:37:47,180 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1 completed in 53.7 seconds
2026-02-14 23:37:47,181 - __main__ - INFO - Algorithm 1 result: MismatchParameters(dx=0.500, dy=2.750, θ=-1.000°, a1=1.9750, α=-0.667°)
2026-02-14 23:37:47,181 - __main__ - INFO - Running Algorithm 2...
2026-02-14 23:37:47,181 - __main__ - ERROR - Algorithm 2 failed: Algorithm2JointGradientRefinement.refine() missing 2 required positional arguments: 'x_true' and 's_nom'
2026-02-14 23:37:47,426 - __main__ - INFO - Scene I (Ideal) PSNR: 40.04 dB
2026-02-14 23:37:47,426 - __main__ - INFO - Scene II (Assumed) PSNR: 23.44 dB
2026-02-14 23:37:47,426 - __main__ - INFO - Scene III (Corrected) PSNR: 28.50 dB
2026-02-14 23:37:47,426 - __main__ - INFO - Gap I→II: 16.60 dB (degradation)
2026-02-14 23:37:47,426 - __main__ - INFO - Gain II→III: 5.06 dB (correction)
2026-02-14 23:37:47,426 - __main__ - INFO - Gap III→I: 11.54 dB (residual)
2026-02-14 23:37:47,427 - __main__ - INFO - scene08 not found, using synthetic scene
2026-02-14 23:37:47,447 - __main__ - INFO - Using scene08: (256, 256, 28)
2026-02-14 23:37:47,447 - __main__ - INFO - 
======================================================================
2026-02-14 23:37:47,447 - __main__ - INFO - Scene 8/10
2026-02-14 23:37:47,447 - __main__ - INFO - ======================================================================
2026-02-14 23:37:47,447 - __main__ - INFO - Scenario I: Ideal reconstruction
2026-02-14 23:37:47,708 - __main__ - INFO - Scenario II: Assumed mask (baseline)
2026-02-14 23:37:47,951 - __main__ - INFO - Scenario III: Corrected mask (Algorithms 1 & 2)
2026-02-14 23:37:47,954 - __main__ - INFO - Running Algorithm 1...
2026-02-14 23:37:47,954 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1: Hierarchical Beam Search starting...
2026-02-14 23:37:47,954 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1: Estimating mask geometry (dx, dy, theta)...
2026-02-14 23:37:52,035 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dx: best=1.0000, mse=0.185958
2026-02-14 23:37:54,891 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dy: best=1.5000, mse=0.185934
2026-02-14 23:37:56,229 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep theta: best=0.3333, mse=0.185943
2026-02-14 23:38:24,612 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Beam search affine: top 5 candidates found, best mse=0.185930
2026-02-14 23:38:24,613 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1 result: dx=1.5000, dy=1.5000, theta=0.3333
2026-02-14 23:38:24,613 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2: Estimating dispersion (a1, alpha)...
2026-02-14 23:38:35,585 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2 result: a1=2.0500, alpha=1.0000
2026-02-14 23:38:35,586 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1 completed in 47.6 seconds
2026-02-14 23:38:35,586 - __main__ - INFO - Algorithm 1 result: MismatchParameters(dx=1.500, dy=1.500, θ=0.333°, a1=2.0500, α=1.000°)
2026-02-14 23:38:35,586 - __main__ - INFO - Running Algorithm 2...
2026-02-14 23:38:35,587 - __main__ - ERROR - Algorithm 2 failed: Algorithm2JointGradientRefinement.refine() missing 2 required positional arguments: 'x_true' and 's_nom'
2026-02-14 23:38:35,828 - __main__ - INFO - Scene I (Ideal) PSNR: 40.03 dB
2026-02-14 23:38:35,828 - __main__ - INFO - Scene II (Assumed) PSNR: 23.43 dB
2026-02-14 23:38:35,828 - __main__ - INFO - Scene III (Corrected) PSNR: 28.49 dB
2026-02-14 23:38:35,828 - __main__ - INFO - Gap I→II: 16.59 dB (degradation)
2026-02-14 23:38:35,828 - __main__ - INFO - Gain II→III: 5.06 dB (correction)
2026-02-14 23:38:35,828 - __main__ - INFO - Gap III→I: 11.54 dB (residual)
2026-02-14 23:38:35,828 - __main__ - INFO - scene09 not found, using synthetic scene
2026-02-14 23:38:35,849 - __main__ - INFO - Using scene09: (256, 256, 28)
2026-02-14 23:38:35,849 - __main__ - INFO - 
======================================================================
2026-02-14 23:38:35,849 - __main__ - INFO - Scene 9/10
2026-02-14 23:38:35,849 - __main__ - INFO - ======================================================================
2026-02-14 23:38:35,849 - __main__ - INFO - Scenario I: Ideal reconstruction
2026-02-14 23:38:36,107 - __main__ - INFO - Scenario II: Assumed mask (baseline)
2026-02-14 23:38:36,363 - __main__ - INFO - Scenario III: Corrected mask (Algorithms 1 & 2)
2026-02-14 23:38:36,365 - __main__ - INFO - Running Algorithm 1...
2026-02-14 23:38:36,366 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1: Hierarchical Beam Search starting...
2026-02-14 23:38:36,366 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1: Estimating mask geometry (dx, dy, theta)...
2026-02-14 23:38:38,913 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dx: best=2.5000, mse=0.186523
2026-02-14 23:38:41,432 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dy: best=0.5000, mse=0.186557
2026-02-14 23:38:42,806 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep theta: best=0.0000, mse=0.186512
2026-02-14 23:39:13,681 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Beam search affine: top 5 candidates found, best mse=0.186497
2026-02-14 23:39:13,681 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1 result: dx=2.2500, dy=0.2500, theta=-0.1000
2026-02-14 23:39:13,682 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2: Estimating dispersion (a1, alpha)...
2026-02-14 23:39:21,449 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2 result: a1=2.0000, alpha=-0.6667
2026-02-14 23:39:21,449 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1 completed in 45.1 seconds
2026-02-14 23:39:21,451 - __main__ - INFO - Algorithm 1 result: MismatchParameters(dx=2.250, dy=0.250, θ=-0.100°, a1=2.0000, α=-0.667°)
2026-02-14 23:39:21,451 - __main__ - INFO - Running Algorithm 2...
2026-02-14 23:39:21,451 - __main__ - ERROR - Algorithm 2 failed: Algorithm2JointGradientRefinement.refine() missing 2 required positional arguments: 'x_true' and 's_nom'
2026-02-14 23:39:21,695 - __main__ - INFO - Scene I (Ideal) PSNR: 40.03 dB
2026-02-14 23:39:21,695 - __main__ - INFO - Scene II (Assumed) PSNR: 23.43 dB
2026-02-14 23:39:21,696 - __main__ - INFO - Scene III (Corrected) PSNR: 28.49 dB
2026-02-14 23:39:21,696 - __main__ - INFO - Gap I→II: 16.60 dB (degradation)
2026-02-14 23:39:21,696 - __main__ - INFO - Gain II→III: 5.06 dB (correction)
2026-02-14 23:39:21,696 - __main__ - INFO - Gap III→I: 11.54 dB (residual)
2026-02-14 23:39:21,696 - __main__ - INFO - scene10 not found, using synthetic scene
2026-02-14 23:39:21,717 - __main__ - INFO - Using scene10: (256, 256, 28)
2026-02-14 23:39:21,717 - __main__ - INFO - 
======================================================================
2026-02-14 23:39:21,717 - __main__ - INFO - Scene 10/10
2026-02-14 23:39:21,717 - __main__ - INFO - ======================================================================
2026-02-14 23:39:21,717 - __main__ - INFO - Scenario I: Ideal reconstruction
2026-02-14 23:39:21,970 - __main__ - INFO - Scenario II: Assumed mask (baseline)
2026-02-14 23:39:22,210 - __main__ - INFO - Scenario III: Corrected mask (Algorithms 1 & 2)
2026-02-14 23:39:22,213 - __main__ - INFO - Running Algorithm 1...
2026-02-14 23:39:22,213 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1: Hierarchical Beam Search starting...
2026-02-14 23:39:22,213 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1: Estimating mask geometry (dx, dy, theta)...
2026-02-14 23:39:25,230 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dx: best=1.5000, mse=0.186324
2026-02-14 23:39:29,948 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep dy: best=2.5000, mse=0.186272
2026-02-14 23:39:32,473 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - 1D sweep theta: best=1.0000, mse=0.186283
2026-02-14 23:40:10,881 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Beam search affine: top 5 candidates found, best mse=0.186262
2026-02-14 23:40:10,882 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 1 result: dx=1.0000, dy=2.5000, theta=0.9500
2026-02-14 23:40:10,882 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2: Estimating dispersion (a1, alpha)...
2026-02-14 23:40:20,462 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Phase 2 result: a1=1.9750, alpha=0.6667
2026-02-14 23:40:20,462 - pwm_core.calibration.cassi_upwmi_alg12 - INFO - Algorithm 1 completed in 58.2 seconds
2026-02-14 23:40:20,463 - __main__ - INFO - Algorithm 1 result: MismatchParameters(dx=1.000, dy=2.500, θ=0.950°, a1=1.9750, α=0.667°)
2026-02-14 23:40:20,463 - __main__ - INFO - Running Algorithm 2...
2026-02-14 23:40:20,463 - __main__ - ERROR - Algorithm 2 failed: Algorithm2JointGradientRefinement.refine() missing 2 required positional arguments: 'x_true' and 's_nom'
2026-02-14 23:40:20,707 - __main__ - INFO - Scene I (Ideal) PSNR: 40.03 dB
2026-02-14 23:40:20,707 - __main__ - INFO - Scene II (Assumed) PSNR: 23.43 dB
2026-02-14 23:40:20,707 - __main__ - INFO - Scene III (Corrected) PSNR: 28.49 dB
2026-02-14 23:40:20,707 - __main__ - INFO - Gap I→II: 16.59 dB (degradation)
2026-02-14 23:40:20,707 - __main__ - INFO - Gain II→III: 5.06 dB (correction)
2026-02-14 23:40:20,707 - __main__ - INFO - Gap III→I: 11.53 dB (residual)
2026-02-14 23:40:20,707 - __main__ - INFO - 
======================================================================
2026-02-14 23:40:20,707 - __main__ - INFO - SUMMARY STATISTICS (10 Scenes)
2026-02-14 23:40:20,707 - __main__ - INFO - ======================================================================
2026-02-14 23:40:20,708 - __main__ - INFO - 
Scenario I (Ideal):
2026-02-14 23:40:20,709 - __main__ - INFO -   Mean PSNR: 40.03 ± 0.00 dB
2026-02-14 23:40:20,709 - __main__ - INFO - 
Scenario II (Assumed, No Correction):
2026-02-14 23:40:20,709 - __main__ - INFO -   Mean PSNR: 23.43 ± 0.00 dB
2026-02-14 23:40:20,709 - __main__ - INFO - 
Scenario III (Corrected with Alg1 & Alg2):
2026-02-14 23:40:20,709 - __main__ - INFO -   Mean PSNR: 28.50 ± 0.00 dB
2026-02-14 23:40:20,709 - __main__ - INFO - 
Gaps and Gains:
2026-02-14 23:40:20,709 - __main__ - INFO -   Gap I→II (degradation): 16.60 ± 0.00 dB
2026-02-14 23:40:20,709 - __main__ - INFO -   Gain II→III (correction): 5.06 ± 0.00 dB
2026-02-14 23:40:20,709 - __main__ - INFO -   Gap III→I (residual): 11.53 ± 0.01 dB
2026-02-14 23:40:20,709 - __main__ - INFO - 
Total execution time: 0.12 hours
2026-02-14 23:40:20,709 - __main__ - INFO - Average time per scene: 0.7 minutes
2026-02-14 23:40:20,711 - __main__ - INFO - 
Results saved to: /home/spiritai/PWM/test2/Physics_World_Model/pwm/reports/cassi_validation_alg12.json
