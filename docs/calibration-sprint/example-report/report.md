# Calibration Sprint Report

**Client:** [ANONYMIZED]
**Modality:** CASSI (Coded Aperture Snapshot Spectral Imaging)
**Date:** 2026-02-01
**Sprint ID:** CS-2026-0042
**Status:** COMPLETE

---

## 1. System Summary

| Parameter | Value |
|-----------|-------|
| Modality | CASSI |
| Detector | 512x512, 16-bit sCMOS |
| Spectral bands | 28 (450-700 nm) |
| Coded aperture | Random binary mask, 50% fill |
| Dispersion element | Amici prism, ~2.1 px/band nominal |
| Noise model | Poisson + Gaussian (read noise sigma = 8.3 DN) |

## 2. Data Received

- 3 snapshot measurements (`.npy`, 512x539 each)
- 1 reference mask image (`.tiff`)
- Manufacturer-specified dispersion: 2.1 px/band

## 3. Calibration Results

### 3.1 Operator Parameters (Before / After)

| Parameter | Nominal | Calibrated | Unit |
|-----------|---------|------------|------|
| Dispersion dx | 2.10 | 2.07 | px/band |
| Dispersion dy | 0.00 | 0.13 | px/band |
| Mask shift x | 0 | -0.4 | px |
| Mask shift y | 0 | 0.2 | px |
| Rotation theta | 0.0 | 0.31 | degrees |

### 3.2 Calibration Method

- **Algorithm:** UPWMI v2 (Uncertain Physics World Model Inference)
- **Grid search:** 3D GPU grid (dx, dy, theta), 9x9x7 = 567 configurations
- **Refinement:** Staged gradient descent (dx first, then dy+theta, then joint)
- **Objective:** Maximize PSNR of GAP-TV reconstruction on calibration frame

### 3.3 Reconstruction Quality

| Solver | Before Calibration | After Calibration | Improvement |
|--------|-------------------|-------------------|-------------|
| GAP-TV (50 iter) | 22.4 dB | 32.6 dB | +10.2 dB |
| PnP-HQS (50 iter) | 23.1 dB | 33.8 dB | +10.7 dB |
| FISTA-TV (100 iter) | 21.8 dB | 31.9 dB | +10.1 dB |

**Best result:** PnP-HQS with calibrated operator: **33.8 dB PSNR**, SSIM = 0.94

## 4. RunBundle Output

The deliverable RunBundle (`CS-2026-0042_bundle/`) contains:

```
CS-2026-0042_bundle/
  runbundle_manifest.json
  data/
    x_gt.npy          (reference reconstruction)
    y.npy             (measurement)
    x_hat.npy         (best reconstruction)
    mask.npy          (calibrated mask)
  results/
    operator_calib.json     (calibrated parameters)
    solver_comparison.json  (all solver results)
```

### Manifest excerpt

```json
{
  "version": "0.3.0",
  "spec_id": "CS-2026-0042-pnp_hqs",
  "timestamp": "2026-02-01T15:42:00Z",
  "provenance": {
    "git_hash": "7e5d82e",
    "seeds": [42],
    "platform": "linux-x86_64",
    "pwm_version": "0.3.0"
  },
  "metrics": {
    "psnr_db": 33.8,
    "ssim": 0.94,
    "runtime_s": 45.2
  }
}
```

## 5. Recommendations

1. **Adopt calibrated dispersion parameters.** The nominal dx=2.10 was close
   but the non-zero dy=0.13 and rotation theta=0.31 degrees were significant
   sources of model mismatch.

2. **Use PnP-HQS as default solver.** It outperformed GAP-TV by ~1.2 dB
   with comparable runtime after calibration.

3. **Re-calibrate after hardware maintenance.** If the prism or mask are
   adjusted, re-run the UPWMI calibration loop. Expected time: ~5 minutes
   on GPU.

4. **Consider increasing spectral sampling.** With the calibrated operator,
   the system could support 31 bands at slightly reduced per-band SNR.

5. **Read noise reduction.** The measured read noise (sigma=8.3) is higher
   than the detector spec (sigma=5.0). Check for electronic interference
   or cooling issues.

## 6. Parameter Sensitivity

Sensitivity analysis around the calibrated operating point:

| Parameter | +/- Range Tested | PSNR Drop at Boundary |
|-----------|------------------|-----------------------|
| dx | +/- 0.5 px | -4.2 dB |
| dy | +/- 0.5 px | -2.8 dB |
| theta | +/- 1.0 deg | -3.1 dB |

The system is most sensitive to dx error, consistent with the primary
dispersion direction.

---

*Report generated by PWM Calibration Sprint. All results are reproducible
from the delivered RunBundle using `pwm run --bundle CS-2026-0042_bundle/`.*
